---
- debug: msg="Galaxy node type is unknown ({{ galaxy_node_type }}). Only portal, wn or pulsar are supported. Assuming wn."
  when: galaxy_node_type != 'portal' and galaxy_node_type != 'wn' and galaxy_node_type != 'pulsar'

# Create galaxy user to launch the daemon
- include: user.yml

- name: Install and pip and setuptools
  package: name=python3-pip,python3-setuptools

- name: Upgrade setuptools
  pip: name=setuptools state=latest executable=pip3

- name: Upgrade pip
  pip:
    name: pip>18.0,<21.0
    executable: pip3

- name: Install virtualenv 
  pip: name=virtualenv executable=pip3

- name: Create {{galaxy_export_dir}}
  file: path={{galaxy_export_dir}} recurse=yes state=directory mode=0777

- name: Include "{{galaxy_node_type}}" recipe
  include: "{{galaxy_node_type}}.yml"
