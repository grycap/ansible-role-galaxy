---
- debug: msg="Galaxy node type is unknown ({{ galaxy_node_type }}). Only portal, wn or pulsar are supported. Assuming wn."
  when: galaxy_node_type != 'portal' and galaxy_node_type != 'wn' and galaxy_node_type != 'pulsar'

# Create galaxy user to launch the daemon
- include: user.yml

- name: Install virtualenv and pip
  package: name=python3-virtualenv,python3-pip,virtualenv
  when: not (ansible_os_family == "RedHat" and ansible_distribution_major_version|int <= 7)

- name: Install pip on RHEL 7-
  package: name=python3-pip
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version|int <= 7

- name: Install virtualenv on RHEL 7-
  pip: name=virtualenv executable=pip3
  when: ansible_os_family == "RedHat" and ansible_distribution_major_version|int <= 7

- name: Create {{galaxy_export_dir}}
  file: path={{galaxy_export_dir}} recurse=yes state=directory mode=0777

- name: Include "{{galaxy_node_type}}" recipe
  include: "{{galaxy_node_type}}.yml"
